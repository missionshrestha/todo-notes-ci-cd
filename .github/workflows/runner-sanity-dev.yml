name: 🧪 Runner Sanity (DEV)
on: workflow_dispatch

jobs:
  hello-dev:
    runs-on: [self-hosted, linux, x64, dev]
    timeout-minutes: 10
    defaults:
      run:
        working-directory: /opt/app

    steps:
      - name: 🛡️ Trust /opt/app for Git (once per host)
        run: git config --global --add safe.directory /opt/app

      - name: 🖥️ Runner & Docker info
        run: |
          echo "👤 user: $(whoami)"
          echo "🧩 groups:" && id
          echo "🐧 kernel:" && uname -a
          echo "🐳 docker:" && docker --version
          echo "🧰 compose:" && docker compose version
          echo "🏷️  runner: ${RUNNER_NAME:-unknown} (${RUNNER_OS:-?}/${RUNNER_ARCH:-?})"
          echo "📁 workspace: ${GITHUB_WORKSPACE:-?}"
          echo "📍 pwd: $(pwd)"

      - name: 📂 Repo status (@ /opt/app)
        run: |
          git -C /opt/app rev-parse --show-toplevel
          echo "— remotes —"
          git -C /opt/app remote -v || true
          echo "— status —"
          git -C /opt/app status --short || true
